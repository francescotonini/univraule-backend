sudo: required
language: node_js
node_js:
  - 10.15.3
services:
  - docker
before_script:
  - 'docker -v'
  - 'export IMAGE_TAG=$(date +%s)'
  - 'export IMAGE_NAME=francescotonini/univrorari-backend'
script:
  - 'docker build --force-rm=true --no-cache -t $IMAGE_NAME:$IMAGE_TAG .'
after_script:
  - 'docker images'
before_deploy:
  - 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
  - 'docker push $IMAGE_NAME:$IMAGE_TAG'
deploy:
  provider: script
  script: 'echo TODO'
  on:
    branch: master